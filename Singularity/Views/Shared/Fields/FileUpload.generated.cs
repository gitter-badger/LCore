#pragma warning disable 1591
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version:4.0.30319.42000
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

namespace ASP
{
    using System;
    
    #line 11 "..\..\Views\Shared\Fields\FileUpload.cshtml"
    using System.Collections;
    
    #line default
    #line hidden
    
    #line 12 "..\..\Views\Shared\Fields\FileUpload.cshtml"
    using System.Collections.Generic;
    
    #line default
    #line hidden
    
    #line 13 "..\..\Views\Shared\Fields\FileUpload.cshtml"
    using System.ComponentModel;
    
    #line default
    #line hidden
    
    #line 19 "..\..\Views\Shared\Fields\FileUpload.cshtml"
    using System.ComponentModel.DataAnnotations;
    
    #line default
    #line hidden
    
    #line 20 "..\..\Views\Shared\Fields\FileUpload.cshtml"
    using System.ComponentModel.DataAnnotations.Schema;
    
    #line default
    #line hidden
    
    #line 14 "..\..\Views\Shared\Fields\FileUpload.cshtml"
    using System.ComponentModel.Design;
    
    #line default
    #line hidden
    using System.IO;
    
    #line 17 "..\..\Views\Shared\Fields\FileUpload.cshtml"
    using System.Linq;
    
    #line default
    #line hidden
    
    #line 18 "..\..\Views\Shared\Fields\FileUpload.cshtml"
    using System.Linq.Expressions;
    
    #line default
    #line hidden
    using System.Net;
    using System.Text;
    
    #line 15 "..\..\Views\Shared\Fields\FileUpload.cshtml"
    using System.Web;
    
    #line default
    #line hidden
    using System.Web.Helpers;
    
    #line 16 "..\..\Views\Shared\Fields\FileUpload.cshtml"
    using System.Web.Mvc;
    
    #line default
    #line hidden
    using System.Web.Mvc.Ajax;
    using System.Web.Mvc.Html;
    using System.Web.Routing;
    using System.Web.Security;
    using System.Web.UI;
    using System.Web.WebPages;
    
    #line 3 "..\..\Views\Shared\Fields\FileUpload.cshtml"
    using LCore;
    
    #line default
    #line hidden
    
    #line 4 "..\..\Views\Shared\Fields\FileUpload.cshtml"
    using Singularity;
    
    #line default
    #line hidden
    
    #line 9 "..\..\Views\Shared\Fields\FileUpload.cshtml"
    using Singularity.Annotations;
    
    #line default
    #line hidden
    
    #line 7 "..\..\Views\Shared\Fields\FileUpload.cshtml"
    using Singularity.Context;
    
    #line default
    #line hidden
    
    #line 6 "..\..\Views\Shared\Fields\FileUpload.cshtml"
    using Singularity.Controllers;
    
    #line default
    #line hidden
    
    #line 10 "..\..\Views\Shared\Fields\FileUpload.cshtml"
    using Singularity.Extensions;
    
    #line default
    #line hidden
    
    #line 5 "..\..\Views\Shared\Fields\FileUpload.cshtml"
    using Singularity.Models;
    
    #line default
    #line hidden
    
    #line 8 "..\..\Views\Shared\Fields\FileUpload.cshtml"
    using Singularity.Routes;
    
    #line default
    #line hidden
    
    [System.CodeDom.Compiler.GeneratedCodeAttribute("RazorGenerator", "2.0.0.0")]
    [System.Web.WebPages.PageVirtualPathAttribute("~/Views/Shared/Fields/FileUpload.cshtml")]
    public partial class _Views_Shared_Fields_FileUpload_cshtml : System.Web.Mvc.WebViewPage<IViewField>
    {
        public _Views_Shared_Fields_FileUpload_cshtml()
        {
        }
        public override void Execute()
        {


WriteLiteral("\r\n\r\n");



















WriteLiteral("\r\n");


            
            #line 22 "..\..\Views\Shared\Fields\FileUpload.cshtml"
  
    ModelContext Context = ContextProviderFactory.GetCurrent().GetContext(Session);

    List<Singularity.Models.FileUpload> CurrentFiles = new List<Singularity.Models.FileUpload>();

    IFileUpload Attr = Model.Meta.GetAttribute<IFileUpload>();

    if (Context.ContextTypes.Has(typeof(Singularity.Models.FileUpload)))
        {
        CurrentFiles = Singularity.Models.FileUpload.GetFileUploads(Context, Model.ModelData, Model.PropertyName).List();
        }


            
            #line default
            #line hidden
WriteLiteral("\r\n");


WriteLiteral("\r\n");


            
            #line 37 "..\..\Views\Shared\Fields\FileUpload.cshtml"
 if (Model.ViewTypes.Has(ControllerHelper.ViewType.Edit))
    {
    if (CurrentFiles.Count > 0 &&
        !Attr.AllowMultipleUploads)
        {
        }
    else
        {

            
            #line default
            #line hidden
WriteLiteral("        <div id=\"upload-file-");


            
            #line 45 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                        Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral("\">\r\n\r\n            <script type=\"text/javascript\">\r\n                $(document).re" +
"ady(function () {\r\n                    $(\'#file-upload-button-");


            
            #line 49 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                      Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral("\').click(function () {\r\n\r\n                        $(\'.file-upload-error-no-file-");


            
            #line 51 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                                 Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral("\').hide();\r\n\r\n                        var fileName = $(\'#file-upload-");


            
            #line 53 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                                  Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral("\').val()\r\n\r\n                        if (!fileName) {\r\n                           " +
" $(\'.file-upload-error-no-file-");


            
            #line 56 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                                     Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral("\').show();\r\n                            return;\r\n                        }\r\n\r\n   " +
"                     $(\'#file-upload-button-");


            
            #line 60 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                          Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral("\').attr(\'disabled\', \'true\');\r\n                        $(\'#file-upload-button-");


            
            #line 61 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                          Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral(" span\').html(\'Uploading\');\r\n\r\n                        var size = null;\r\n\r\n       " +
"                 var restrictFileType = ");


            
            #line 65 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                           Write(Attr.AllowFileTypes == null || Attr.AllowFileTypes.Length == 0 ? "false" : "true");

            
            #line default
            #line hidden
WriteLiteral(";\r\n\r\n                        $(\'.file-upload-error-incorrect-type-");


            
            #line 67 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                                         Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral("\').hide();\r\n\r\n                        if (restrictFileType)\r\n                    " +
"    {\r\n                            var fileTypes = ");


            
            #line 71 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                       Write(Html.Raw("['" + Attr.AllowFileTypes.JoinLines("','").ToLower().ReplaceAll(".","") + "']"));

            
            #line default
            #line hidden
WriteLiteral(@";

                            var typeFound = false;
                            for (var i = 0 ; i < fileTypes.length; i++)
                            {
                                if (fileName.toLowerCase().indexOf(fileTypes[i]) == fileName.length - fileTypes[i].length)
                                {
                                    typeFound = true;
                                    break;
                                }
                            }
                            if (!typeFound)
                            {
                                $('.file-upload-error-incorrect-type-");


            
            #line 84 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                                                 Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral("\').show();\r\n                                return;\r\n                            " +
"}\r\n                        }\r\n\r\n                        if ($(\'#file-upload-");


            
            #line 89 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                        Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral("\')[0].files && $(\'#file-upload-");


            
            #line 89 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                                                                            Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral("\')[0].files[0])\r\n                            size = $(\'#file-upload-");


            
            #line 90 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                               Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral("\')[0].files[0].size;\r\n\r\n                        $(\'.file-upload-error-too-small-");


            
            #line 92 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                                    Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral("\').hide();\r\n                        $(\'.file-upload-error-too-large-");


            
            #line 93 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                                    Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral("\').hide();\r\n\r\n                        if (size != null) {\r\n\r\n                    " +
"        if (size < ");


            
            #line 97 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                   Write(Attr.SizeMinimum);

            
            #line default
            #line hidden
WriteLiteral(" )\r\n                            {\r\n                            $(\'.file-upload-er" +
"ror-too-small-");


            
            #line 99 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                                        Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral("\').show();\r\n                            return;\r\n                        }\r\n\r\n   " +
"                     if (size > ");


            
            #line 103 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                               Write(Attr.SizeMaximum);

            
            #line default
            #line hidden
WriteLiteral(" )\r\n                        {\r\n                        $(\'.file-upload-error-too-" +
"large-");


            
            #line 105 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                                    Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral("\').show();\r\n                        return;\r\n                    }\r\n             " +
"       }\r\n\r\n                    var ParentForm = $(\'#file-upload-button-");


            
            #line 110 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                                       Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral("\').parents(\'form\')[0];\r\n\r\n                $.ajax({\r\n                    url: \'/");


            
            #line 113 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                       Write(Html.ControllerName());

            
            #line default
            #line hidden
WriteLiteral("/UploadFile?ReturnURL=");


            
            #line 113 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                                                    Write(Request.Url.AbsoluteUri);

            
            #line default
            #line hidden
WriteLiteral("&RelationType=");


            
            #line 113 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                                                                                          Write(Model.ModelData.TrueModelType().FullName);

            
            #line default
            #line hidden
WriteLiteral("&RelationProperty=");


            
            #line 113 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                                                                                                                                                     Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral("&RelationID=");


            
            #line 113 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                                                                                                                                                                                    Write(Model.ModelData.GetID());

            
            #line default
            #line hidden
WriteLiteral(@"',
                    type: 'POST',
                    data: new FormData(ParentForm),
                    processData: false,
                    contentType: false,

                    success: function (data) {
                        location.reload();
                    },
                    error: function (e) {
                        console.log(e);
                        $('.file-upload-error-");


            
            #line 124 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                         Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral("\').show();\r\n                    }\r\n                });\r\n                });\r\n    " +
"            });\r\n            </script>\r\n\r\n            <input type=\"file\" class=\"" +
"file-upload\" id=\"file-upload-");


            
            #line 131 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                                              Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral("\" name=\"UploadFile");


            
            #line 131 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                                                                                    Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral("\" />\r\n\r\n            <div class=\"file-upload-error-incorrect-type-");


            
            #line 133 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                                    Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral(" error\" style=\"display:none;\">\r\n                File types allowed: ");


            
            #line 134 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                Write(Attr.AllowFileTypes.JoinLines(", ").ToUpper().ReplaceAll(".", ""));

            
            #line default
            #line hidden
WriteLiteral("\r\n            </div>\r\n\r\n            <div class=\"file-upload-error-too-large-");


            
            #line 137 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                               Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral(" error\" style=\"display:none;\">\r\n                Upload can not be larger than <b>" +
"");


            
            #line 138 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                            Write(Attr.SizeMaximum.FormatFileSize(2));

            
            #line default
            #line hidden
WriteLiteral("</b>\r\n            </div>\r\n\r\n            <div class=\"file-upload-error-too-small-");


            
            #line 141 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                               Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral(" error\" style=\"display:none;\">\r\n                Upload must be at least <b>");


            
            #line 142 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                      Write(Attr.SizeMinimum.FormatFileSize(2));

            
            #line default
            #line hidden
WriteLiteral("</b>\r\n            </div>\r\n\r\n            <div class=\"file-upload-error-no-file-");


            
            #line 145 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                             Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral(" error\" style=\"display:none;\">\r\n                Please select a file to upload.\r\n" +
"            </div>\r\n\r\n            <div class=\"file-upload-error-");


            
            #line 149 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                     Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral(" error\" style=\"display:none;\">\r\n                An error occured while uploading " +
"this file.\r\n            </div>\r\n\r\n            <div class=\"btn btn-default\" id=\"f" +
"ile-upload-button-");


            
            #line 153 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                                           Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral("\">\r\n                <glyph>&#xE027;</glyph>\r\n                <span>Upload</span>\r" +
"\n            </div>\r\n        </div>\r\n");


            
            #line 158 "..\..\Views\Shared\Fields\FileUpload.cshtml"
        }
    }
else if (Model.ViewTypes.Has(ControllerHelper.ViewType.TableCell))
    {
    }
else if (Model.ViewTypes.Has(ControllerHelper.ViewType.Display))
    {
    }

            
            #line default
            #line hidden
WriteLiteral("\r\n");


            
            #line 167 "..\..\Views\Shared\Fields\FileUpload.cshtml"
 if (Model.ViewTypes.Has(ControllerHelper.ViewType.Edit) ||
    Model.ViewTypes.Has(ControllerHelper.ViewType.Display))
    {
    foreach (Singularity.Models.FileUpload File in CurrentFiles)
        {
        String Ext = System.IO.Path.GetExtension(File.FilePath);

        if (Ext.StartsWith("."))
            {
            Ext = Ext.Substring(1);
            }


            
            #line default
            #line hidden
WriteLiteral("        <div class=\"display-file border-round\">\r\n\r\n            <div class=\"file-i" +
"con\">\r\n                <a href=\"");


            
            #line 182 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                     Write(Url.Controller<ManageController>().Action(c => c.DownloadFile, File.FileUploadID));

            
            #line default
            #line hidden
WriteLiteral("\">\r\n                    <img src=\"/Content/icons/32px/");


            
            #line 183 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                              Write(Ext);

            
            #line default
            #line hidden
WriteLiteral(".png\" alt=\"Image not found\" error-src=\"/Content/icons/32px/_blank.png\" />\r\n      " +
"          </a>\r\n            </div>\r\n            <div>\r\n                <a href=\"" +
"");


            
            #line 187 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                     Write(Url.Controller<ManageController>().Action(c => c.DownloadFile, File.FileUploadID));

            
            #line default
            #line hidden
WriteLiteral("\">\r\n                    Name:\r\n                    ");


            
            #line 189 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                Write(System.IO.Path.GetFileName(File.FilePath));

            
            #line default
            #line hidden
WriteLiteral("\r\n                </a>\r\n            </div>\r\n\r\n            <div>\r\n                " +
"Size:\r\n                ");


            
            #line 195 "..\..\Views\Shared\Fields\FileUpload.cshtml"
           Write(File.FileSize.FormatFileSize(1));

            
            #line default
            #line hidden
WriteLiteral("\r\n            </div>\r\n\r\n");


            
            #line 198 "..\..\Views\Shared\Fields\FileUpload.cshtml"
             if (Attr.AllowDeactivate)
                {

            
            #line default
            #line hidden
WriteLiteral("                <a class=\"btn btn-default\" id=\"file-upload-button-");


            
            #line 200 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                                                             Write(Model.PropertyName);

            
            #line default
            #line hidden
WriteLiteral("\"\r\n                   href=\"");


            
            #line 201 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                     Write(Url.Controller<ManageController>().Action(c => c.DeleteFile, File.FileUploadID, Request.Url.AbsoluteUri));

            
            #line default
            #line hidden
WriteLiteral("\">\r\n                    <glyph>&#xe014;</glyph>\r\n                    Remove\r\n    " +
"            </a>\r\n");


            
            #line 205 "..\..\Views\Shared\Fields\FileUpload.cshtml"
                }

            
            #line default
            #line hidden
WriteLiteral("        </div>\r\n");


            
            #line 207 "..\..\Views\Shared\Fields\FileUpload.cshtml"
        }
    }

            
            #line default
            #line hidden

        }
    }
}
#pragma warning restore 1591
